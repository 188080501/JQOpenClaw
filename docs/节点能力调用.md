# 节点能力调用说明

本文档描述 JQOpenClawNode 当前支持的 `node.invoke` 命令、参数约束与返回重点字段。

## 1. 通用请求结构

```json
{
  "method": "node.invoke",
  "params": {
    "nodeId": "<node-id>",
    "command": "<command-name>",
    "params": {},
    "timeoutMs": 30000,
    "idempotencyKey": "<uuid>"
  }
}
```

## 2. file.read

读取文件内容。

参数（`params`）：
- `path`：字符串，必填。
- `encoding`：字符串，可选，`utf8`（默认）或 `base64`。
- `maxBytes`：数字，可选，默认 `1048576`，范围 `[1, 20971520]`。

返回（payload）：
- `path`
- `encoding`
- `sizeBytes`
- `readBytes`
- `truncated`
- `content`

## 3. file.write

写入文件内容。

参数（`params`）：
- `path`：字符串，必填。
- `content`：字符串，必填。
- `encoding`：字符串，可选，`utf8`（默认）或 `base64`。
- `append`：布尔，可选，默认 `false`。
- `createDirs`：布尔，可选，默认 `true`。

返回（payload）：
- `path`
- `encoding`
- `appended`
- `bytesWritten`
- `sizeBytes`

## 4. process.exec

远程执行进程命令（QProcess）。

参数（`params`）：
- `command`：字符串，可选。存在时走 `cmd.exe /C`。
- `program`：字符串，可选。`command` 为空时必填。
- `arguments`：字符串数组，可选。
- `workingDirectory`：字符串，可选。
- `stdin`：字符串，可选。
- `timeoutMs`：数字，可选，默认 `30000`，范围 `[100, 300000]`。
- `inheritEnvironment`：布尔，可选，默认 `true`。
- `environment`：对象，可选，键值都需为字符串。
- `mergeChannels`：布尔，可选，默认 `false`。

返回（payload）：
- `program`
- `arguments`
- `workingDirectory`
- `timeoutMs`
- `elapsedMs`
- `timedOut`
- `exitCode`
- `exitStatus`
- `stdout`
- `stderr`
- `ok`：布尔。是否为正常完成且 `exitCode == 0`。
- `resultClass`：字符串。`ok` / `non_zero_exit` / `crash` / `timeout`。
- `processError`：数字，可选。仅在存在进程级错误时返回。
- `processErrorName`：字符串，可选。仅在存在进程级错误时返回，取值：`failed_to_start` / `crashed` / `timed_out` / `read_error` / `write_error`。
- `processErrorString`：字符串，可选。仅在存在进程级错误时返回。

判定建议：
- 优先使用 `ok` 与 `resultClass`。
- 无进程级错误时，不返回 `processError*` 字段。

## 5. system.screenshot

采集全部屏幕截图并上传，返回图片 URL 列表。

返回（payload 数组元素）：
- `format`
- `mimeType`
- `url`
- `width`
- `height`
- `screenIndex`
- `screenName`（可选）

## 6. system.info

采集系统基础信息。

返回（payload）：
- `cpuName`
- `cpuCores`
- `cpuThreads`
- `computerName`
- `memory`
- `gpuNames`
- `ip`
- `disks`
